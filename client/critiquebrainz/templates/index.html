{% extends 'base.html' %}
{% block content %}
<h4>Last reviews</h4>
{% if not reviews %}
  <p class="lead" style="text-align: center;">No reviews found</p>
{% else %}
  <table id="last-reviews" class="table table-condensed table-hover">
    <thead>
      <tr>
        <th><!-- Cover art --></th>
        <th>Artist</th>
        <th>Release group</th>
        <th>Author</th>
      </tr>
    </thead>
    <tbody>
      {% for review in reviews %}
        {% set release_group = review.release_group|release_group_details %}
        <tr class="clickable-row" data-url="{{ url_for('review.entity', id=review.id) }}" data-review-id="{{ review.id }}">
          <td>
            <img class="cover-art">
            <script>
              $("img").last()
                  .on("error", function () { $(this).attr("src", "/static/img/missing-art.png"); })
                  .attr("src", "//coverartarchive.org/release-group/{{ review.release_group }}/front-250");
            </script>
          </td>
          <td>{{ release_group.artist }}</td>
          <td>
            {{ release_group.title }}
            {% if release_group.first_release_date %}
              <span class="text-muted">({{ release_group.first_release_date }})</span>
            {% endif %}
          </td>
          <td>{{ review.user.display_name }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}
{% endblock %}
