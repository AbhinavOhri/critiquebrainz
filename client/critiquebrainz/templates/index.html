{% extends 'base.html' %}
{% block content %}
<div id="homepage">

  <div class="clearfix">
    <h3 class="pull-left">Welcome to CritiqueBrainz!</h3>
    <a href="{{ url_for('profile_review.create') }}"
       role="button" class="btn btn-primary pull-right">
      <span class="glyphicon glyphicon-asterisk"></span> Write a review
    </a>
  </div>

  <div id="project-description" class="row">
    <div class="col-md-8">
      <p>
        CritiqueBrainz is a repository for Creative Commons licensed music reviews.
        Here you can read what other people have written about an album or
        <a href="{{ url_for('profile_review.create') }}">write</a> your own review!
      </p>
      <p>
        CritiqueBrainz is based on data from <a href="//musicbrainz.org">MusicBrainz</a> - open music encyclopedia.
        <br/>Everyone - including you - can participate and contribute.
      </p>
    </div>
    <div class="col-md-4">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Stats</h3>
        </div>
        <div class="panel-body">
          <b>Reviews:</b> {{ reviews_total }}
        </div>
      </div>
    </div>
  </div>

  <div id="lists" class="row">
    <div class="col-md-6">
      <h4>Hot reviews</h4>
      {% if not hot_reviews %}
        <p class="lead" style="text-align: center;">No reviews found</p>
      {% else %}
        <ul class="list-unstyled reviews">
          {% for review in hot_reviews %}
            {% set release_group = review.release_group|release_group_details %}
            <li class="clearfix clickable-row" data-url="{{ url_for('review.entity', id=review.id) }}">
              <img class="cover-art pull-left">
              <script>
                $("img").last()
                    .on("error", function () { $(this).attr("src", "/static/img/missing-art.png"); })
                    .attr("src", "//coverartarchive.org/release-group/{{ review.release_group }}/front-250");
              </script>
              <div class="album"><b>{{ release_group.title }}</b> - {{ release_group.artist }}</div>
              <div class="reviewer">
                Review by <img class="avatar" src="{{ review.user.avatar }}&s=16" /> {{ review.user.display_name }}
              </div>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>

    <div class="col-md-6">
      <h4>Recent reviews</h4>
      {% if not recent_reviews %}
        <p class="lead" style="text-align: center;">No reviews found</p>
      {% else %}
        <ul class="list-unstyled reviews">
          {% for review in recent_reviews %}
            {% set release_group = review.release_group|release_group_details %}
            <li class="clearfix clickable-row" data-url="{{ url_for('review.entity', id=review.id) }}">
              <img class="cover-art pull-left">
              <script>
                $("img").last()
                    .on("error", function () { $(this).attr("src", "/static/img/missing-art.png"); })
                    .attr("src", "//coverartarchive.org/release-group/{{ review.release_group }}/front-250");
              </script>
              <div class="album"><b>{{ release_group.title }}</b> - {{ release_group.artist }}</div>
              <div class="reviewer">
                Review by <img class="avatar" src="{{ review.user.avatar }}&s=16" /> {{ review.user.display_name }}
              </div>
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
  </div>

</div>
{% endblock %}
